<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>ES6</title>
</head>
<body>
</body>
<script type="text/javascript">
	console.log('---- let 声明的变量只作用在代码块内') 
	{
		let a = 1;
		var b = 2;
	}

	console.log(b);
	console.log(a);
</script>

<script type="text/javascript">
	console.log('----');
	for (let i = 0; i < 5; i ++) {}
	console.log(i);
</script>

<script type="text/javascript">
	console.log('---- var');
	var a = [];
	for (var i = 0; i < 5; i++) {
		a[i] = function () {
			console.log(i);
		}
		console.log('var i:' + i);
	}
	// console.log(a[3])
	console.log('a[3]:' + a[3]());

	console.log('---- length')
	var a = [];
	for (let i = 0; i < 5; i++) {
		a[i] = function () {
			console.log(i);
		}
		console.log('let i:' + i);
	}
	// console.log(a[3])
	console.log('a[3]:' + a[3]());
</script>

<script type="text/javascript">
	console.log('---- for loop 中, 设置循环变量部分是父作用域名, 循环体是子作用域');
	for (let i = 0; i < 3; i++) {
		// console.log(i)
		let i = 'abc';
		console.log(i)
	}
	for (let i = 0; i < a.length; i++){
		if (i == 1) {
			console.log(a[i]);	// function (){}
			console.log(typeof a[i]);	// function
		}
	}
</script>

<script type="text/javascript">
	console.log('----')
	console.log('var 会发生`变量提升`现象, 变量在声明前使用, 值为 `undefined`')
	console.log(foo);
	var foo = 2;
	console.log('let 不存在变量提升')
	console.log(bar);
	let boo = 2;
</script>
<script type="text/javascript">
	console.log('-----');
	console.log('暂时性死区 (temporal dead zone, TDZ)')
	console.log('ES6 明确规定，如果区块中存在let和const命令，\n这个区块对这些命令声明的变量，\n从一开始就形成了封闭作用域。凡是在声明之前就使用这些变量，就会报错。')
	if (1) {
		tmp = 'abc'
		console.log(tmp);
		let tmp;
	}
</script>

<script type="text/javascript">
	if (1) {
		temp = 'abc';
		console.log(temp);
		let temp;
		console.log(temp);

		temp = 123;
		console.log(temp);
	}
</script>
we
<script type="text/javascript">
	console.log('-----');
	console.log('TDZ 也意味着 typeof 不再是 100% 安全的操作')

	console.log(typeof undefined_variable);
	typeof x;
	let x;
	
</script>

<script type="text/javascript">
	console.log("隐蔽的'死区'")
	function foo(x = 2, y = x) {
		return [x, y]
	}
	foo(); // 正常

	function bar(x = y, y = 2) {
		return [x, y];
	}
	bar();
</script>
<script type="text/javascript">
	console.log('----');
	var z = z; // 正常
	let y = y; // 报错
</script>
<script type="text/javascript">
	console.log('不允许重复声明');
	function func() {
		let a = 10;
		var a = 1;
	}
	func();
</script>
<script type="text/javascript">
	console.log('----');
	function func() {
		let a = 10;
		let a = 1;
	}
	func();
</script>
<script type="text/javascript">
	console.log('----');
	function func(args) {
		let args;
	}
	func();
</script>
<script type="text/javascript">
	console.log('----');
	function func(args) {
		{
			let args;
		}
	}
	func(); // 正常
</script>
<script type="text/javascript">
	console.log('----');
	console.log('if代码块的外部使用外层的tmp变量，内部使用内层的tmp变量。但是，函数f执行后，输出结果为undefined，原因在于变量提升，导致内层的tmp变量覆盖了外层的tmp变量。')
	var tmp = new Date();
	function f() {
		console.log(tmp);
		if (false) {
			var tmp = 'hello world';
		}
	}
	f(); //undefined
</script>
<script type="text/javascript">
	console.log('----');
	var s = 'hello';
	for (var i = 0; i < s.length; i++) {
		console.log(s[i]);
	}
	console.log(i); //5
</script>
<script type="text/javascript">
	console.log('----');
	console.log('块级作用域');
</script>
</html>